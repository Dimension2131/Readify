<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Progress Tracker - Readify</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="assets/images/favicon.png">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">Readify</a>
            
            <button class="hamburger" aria-label="Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="explorer.html">Book Explorer</a></li>
                <li><a href="tracker.html" class="active">Progress Tracker</a></li>
                <li><a href="recommender.html">Book Recommender</a></li>
                <li><a href="flow.html">Reading Flow</a></li>
                <li><a href="feedback.html">Feedback</a></li>
            </ul>
        </div>
    </nav>

    <main class="tracker-container">
        <div class="container">
            <header class="tracker-header">
                <h1 class="page-title">Reading Progress Tracker</h1>
                <p class="page-subtitle">Track your reading progress and estimate completion time</p>
            </header>

            <div class="tracker-grid">
                <div class="tracker-card input-card">
                    <h2 class="card-title">Track Your Book</h2>
                    
                    <form class="progress-form" id="progress-form">
                        <div class="form-group">
                            <label for="book-title">Book Title</label>
                            <input type="text" id="book-title" placeholder="Enter book title" value="Murim Login">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="total-pages">Total Pages</label>
                                <input type="number" id="total-pages" min="1" value="180" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="pages-read">Pages Read</label>
                                <input type="number" id="pages-read" min="0" value="45" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="reading-speed">Daily Reading Speed (pages per day)</label>
                            <div class="slider-container">
                                <input type="range" id="reading-speed" min="5" max="100" value="30">
                                <span class="slider-value" id="speed-value">30</span>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn-primary">Calculate Progress</button>
                            <button type="button" class="btn-secondary" id="save-progress">Save Progress</button>
                        </div>
                    </form>
                </div>

                <!-- Results -->
                <div class="tracker-card results-card">
                    <h2 class="card-title">Progress Overview</h2>
                    
                    <div class="progress-section">
                        <div class="progress-header">
                            <h3 id="current-book">Murim Login</h3>
                            <span class="progress-percent" id="percent-complete">25%</span>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                        </div>
                        
                        <div class="progress-stats">
                            <div class="stat">
                                <span class="stat-label">Pages Read</span>
                                <span class="stat-value" id="pages-read-display">45</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Remaining</span>
                                <span class="stat-value" id="pages-remaining">135</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Progress</span>
                                <span class="stat-value">25%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="estimation-section">
                        <h3>Estimated Completion</h3>
                        <div class="estimation-card">
                            <div class="estimation-icon">ðŸ“…</div>
                            <div class="estimation-info">
                                <p class="estimation-label">Days to finish</p>
                                <p class="estimation-value" id="days-to-finish">5 days</p>
                            </div>
                        </div>
                        
                        <div class="estimation-card">
                            <div class="estimation-icon">ðŸŽ¯</div>
                            <div class="estimation-info">
                                <p class="estimation-label">Target date</p>
                                <p class="estimation-value" id="target-date">Jan 10, 2024</p>
                            </div>
                        </div>
                        
                        <div class="estimation-card">
                            <div class="estimation-icon">ðŸ“Š</div>
                            <div class="estimation-info">
                                <p class="estimation-label">Daily goal</p>
                                <p class="estimation-value" id="daily-goal">27 pages/day</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Saved Books -->
                <div class="tracker-card saved-card">
                    <h2 class="card-title">Saved Progress</h2>
                    
                    <div class="saved-books-list" id="saved-books">
                        <p class="empty-message" id="empty-message">No saved progress yet. Save your current progress to see it here.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3>Readify</h3>
                <p>Makes reading fun for all ages</p>
            </div>
            
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="explorer.html">Book Explorer</a></li>
                    <li><a href="tracker.html">Progress Tracker</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Tools</h4>
                <ul>
                    <li><a href="recommender.html">Book Recommender</a></li>
                    <li><a href="flow.html">Reading Flow</a></li>
                    <li><a href="feedback.html">Feedback</a></li>
                </ul>
            </div>
            
        </div>
        
        <div class="footer-bottom">
            <p>Readify. Makes reading fun for all ages</p>
        </div>
    </footer>

    <script src="js/utils.js"></script>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('progress-form');
            const saveButton = document.getElementById('save-progress');
            const speedSlider = document.getElementById('reading-speed');
            const speedValue = document.getElementById('speed-value');
            const savedBooksList = document.getElementById('saved-books');
            const emptyMessage = document.getElementById('empty-message');
            
            loadSavedProgress();
            
            // Update slider value display
            speedSlider.addEventListener('input', function() {
                speedValue.textContent = this.value;
            });
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                calculateProgress();
            });
            
            saveButton.addEventListener('click', saveProgress);
            
            calculateProgress();
            
            function calculateProgress() {
                const bookTitle = document.getElementById('book-title').value;
                const totalPages = parseInt(document.getElementById('total-pages').value);
                const pagesRead = parseInt(document.getElementById('pages-read').value);
                const readingSpeed = parseInt(document.getElementById('reading-speed').value);
                
                // Page input validation
                if (pagesRead > totalPages) {
                    alert('Pages read cannot exceed total pages');
                    return;
                }
                
                // Progress Calculations
                const percentComplete = Math.round((pagesRead / totalPages) * 100);
                const pagesRemaining = totalPages - pagesRead;
                const daysToFinish = Math.ceil(pagesRemaining / readingSpeed);
                
                // getting the current date
                const targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + daysToFinish);
                const formattedDate = targetDate.toLocaleDateString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric'
                });
                
                // A daily goal (amount of pages to read daily to finish in a week or less)
                const dailyGoal = Math.ceil(pagesRemaining / 7);
                
                document.getElementById('current-book').textContent = bookTitle;
                document.getElementById('percent-complete').textContent = `${percentComplete}%`;
                document.getElementById('pages-read-display').textContent = pagesRead;
                document.getElementById('pages-remaining').textContent = pagesRemaining;
                document.getElementById('days-to-finish').textContent = `${daysToFinish} day${daysToFinish !== 1 ? 's' : ''}`;
                document.getElementById('target-date').textContent = formattedDate;
                document.getElementById('daily-goal').textContent = `${dailyGoal} pages/day`;
                
                const progressFill = document.getElementById('progress-fill');
                progressFill.style.width = `${percentComplete}%`;

                progressFill.classList.remove('animate');
                void progressFill.offsetWidth;
                progressFill.classList.add('animate');
            }
            
            function saveProgress() {
                const bookTitle = document.getElementById('book-title').value;
                const totalPages = parseInt(document.getElementById('total-pages').value);
                const pagesRead = parseInt(document.getElementById('pages-read').value);
                const readingSpeed = parseInt(document.getElementById('reading-speed').value);
                
                if (!bookTitle) {
                    alert('Please enter a book title');
                    return;
                }
                
                const progressData = {
                    id: Date.now(),
                    title: bookTitle,
                    totalPages: totalPages,
                    pagesRead: pagesRead,
                    readingSpeed: readingSpeed,
                    date: new Date().toISOString(),
                    percentComplete: Math.round((pagesRead / totalPages) * 100)
                };
                
                let savedProgress = JSON.parse(localStorage.getItem('readify_progress') || '[]');
                const existingIndex = savedProgress.findIndex(item => item.title === bookTitle);
                
                if (existingIndex >= 0) {
                    savedProgress[existingIndex] = progressData;
                } else {
                    savedProgress.push(progressData);
                }
                
                // Saving new item to local storage
                localStorage.setItem('readify_progress', JSON.stringify(savedProgress));
                loadSavedProgress();
                
                const originalText = saveButton.textContent;
                saveButton.textContent = 'Saved!';
                saveButton.classList.add('saved');
                
                setTimeout(() => {
                    saveButton.textContent = originalText;
                    saveButton.classList.remove('saved');
                }, 2000);
            }
            
            function loadSavedProgress() {
                const savedProgress = JSON.parse(localStorage.getItem('readify_progress') || '[]');
                savedBooksList.innerHTML = '';
                
                if (savedProgress.length === 0) {
                    emptyMessage.style.display = 'block';
                    return;
                }
                
                emptyMessage.style.display = 'none';
                
                // Sorting list by the most recent addition
                savedProgress.sort((a, b) => b.id - a.id);
                
                savedProgress.forEach(item => {
                    const bookElement = document.createElement('div');
                    bookElement.className = 'saved-book';
                    bookElement.innerHTML = `
                        <div class="saved-book-info">
                            <h4 class="saved-book-title">${item.title}</h4>
                            <p class="saved-book-meta">${item.pagesRead}/${item.totalPages} pages (${item.percentComplete}%)</p>
                        </div>
                        <div class="saved-book-actions">
                            <button class="btn-small load-btn" data-id="${item.id}">Load</button>
                            <button class="btn-small delete-btn" data-id="${item.id}">Delete</button>
                        </div>
                    `;
                    
                    savedBooksList.appendChild(bookElement);
                });
                
                document.querySelectorAll('.load-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const id = parseInt(this.dataset.id);
                        loadProgress(id);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const id = parseInt(this.dataset.id);
                        deleteProgress(id);
                    });
                });
            }
            
            function loadProgress(id) {
                const savedProgress = JSON.parse(localStorage.getItem('readify_progress') || '[]');
                const progress = savedProgress.find(item => item.id === id);
                
                if (progress) {
                    document.getElementById('book-title').value = progress.title;
                    document.getElementById('total-pages').value = progress.totalPages;
                    document.getElementById('pages-read').value = progress.pagesRead;
                    document.getElementById('reading-speed').value = progress.readingSpeed;
                    speedValue.textContent = progress.readingSpeed;
                    
                    calculateProgress();
                    
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            }
            
            function deleteProgress(id) {
                let savedProgress = JSON.parse(localStorage.getItem('readify_progress') || '[]');
                savedProgress = savedProgress.filter(item => item.id !== id);
                
                localStorage.setItem('readify_progress', JSON.stringify(savedProgress));
                loadSavedProgress();
            }
        });
    </script>
</body>
</html>